# 2017 BugsBunny - [CRYPTO] Scy Way

## Key words

- RSA
- Small N

## Solution

문제에 다음과 같이 `n`과 `e`를 제공해줍니다.

```
n = 20473673450356553867543177537
e = 17
```

그리고 문제는 다음과 같이 암호화된 숫자를 제공합니다.

```
18007889962634106437498506527
11990331606262088523432887149
18325224314427832750886933152
2760600571233694421375851936
8339139607628185334878470624
18007889962634106437498506527
11990331606262088523432887149
14414259879391194767307868195
14414259879391194767307868195
18255834802712547678413098267
13711885442374245344677746317
18007889962634106437498506527
11991065287026748767929947797
11126563179310494209093218793
18255834802712547678413098267
8339139607628185334878470624
11046510144681737785307885537
2990306588161169678135125118
7220739821781705584934723711
8339139607628185334878470624
19610168773606821109881392187
18870244401538467439794599727
2760600571233694421375851936
8339139607628185334878470624
12384246926176513410361900584
14489177490521003680409811447
14489177490521003680409811447
14572810092087752772506211289
8339139607628185334878470624
14378769716278894785733888650
8118703413744428194066731810
17447992043028743677170987865
4461575008381447860994453166
8339139607628185334878470624
2760600571233694421375851936
11100858468474140765623108059
3982444918630147102242192455
14489177490521003680409811447
14489177490521003680409811447
14572810092087752772506211289
8339139607628185334878470624
3982444918630147102242192455
11991065287026748767929947797
4957536150287848810526471254
7220739821781705584934723711
3982444918630147102242192455
11991065287026748767929947797
298781897506363694334710597
```

일단 취약점은 `n`이 너무 작기 때문에 쉽게 `factorization`이 가능합니다. 먼저, `n`을 분해하여 `p`와 `q`를 찾습니다.

> https://factordb.com/

```
p = 2165121523231
q = 9456131321351327
```

이 값을 이용하여 `phi` 값과 `d`값을 구할 수 있는데, 한 가지 주의할 점은 `d`를 구할 때, `invert` 연산시 값이 음수로 나와 정상적인 계산이 되질 않습니다. 

이 경우, 나온 `d`값에 대해 다시 `phi`로 모듈러 연산을 해주게 되면 정상적으로 값이 나오게 됩니다.

## Solution Code

```python
# N: 20473673450356553867543177537
# e: 17

fd = open("Baby_RSA.txt", "r")
data = fd.read()
fd.close()

def egcd(a, b):
    x, y, u, v = 0, 1, 1, 0
    while a != 0:
        q, r = b // a, b % a
        m, n = x - u * q, y - v * q
        b, a, x, y, u, v = a, r, u, v, m, n
        gcd = b
    return gcd, x, y

def decrypt(p, q, e, ct):
    n = p * q
    phi = (p - 1) * (q - 1)
    gcd, a, b = egcd(e, phi)
    d = a % phi
    pt = pow(ct, d, n)
    return hex(pt)[2:-1].decode("hex")


p = 2165121523231
q = 9456131321351327
phi = (p-1) * (q-1)
n = p * q
e = 17

res = ""
for l in data.splitlines():
    res += decrypt(p, q, e, int(l))
print res
```

> Bugs_Bunny{Baby_RSA_Its_Cool_Lik3_school_haHAha}